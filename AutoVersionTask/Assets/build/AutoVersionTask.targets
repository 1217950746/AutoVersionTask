<Project>
    <PropertyGroup>
        <AutoVersionTaskFolder>$(MSBuildThisFileDirectory)..\tasks\net472\</AutoVersionTaskFolder>
    </PropertyGroup>
    <PropertyGroup Condition="$(AutoVersionDebug) == 'true'">
        <AutoVersionTaskFolder>..\..\bin\Debug\net472\</AutoVersionTaskFolder>
    </PropertyGroup>

    <UsingTask TaskName="MainTask" AssemblyFile="$(AutoVersionTaskFolder)AutoVersionTask.dll" />

    <Target Name="MainTaskTarget" BeforeTargets="CoreCompile" Condition="$(Version) == '1.0.0'">
        <MainTask SolutionDir="$(ProjectDir)">
            <Output TaskParameter="AutoVersion" PropertyName="AutoVersion" />
            <Output TaskParameter="AutoVersionSuffix" PropertyName="AutoVersionSuffix" />
            <Output TaskParameter="AutoFullVersion" PropertyName="AutoFullVersion" />
        </MainTask>
        <PropertyGroup>
            <Version>$(AutoFullVersion)</Version>
            <VersionPrefix>$(AutoVersion)</VersionPrefix>
            <VersionSuffix>$(AutoVersionSuffix)</VersionSuffix>
            <PackageVersion>$(AutoVersion)</PackageVersion>
        </PropertyGroup>
    </Target>
</Project>

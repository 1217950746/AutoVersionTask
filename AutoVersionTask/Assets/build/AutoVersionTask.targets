<Project>
    <PropertyGroup>
        <AutoVersionTaskFolder Condition=" '$(AutoVersionTaskDebug)' == 'True' ">$(SolutionDir)bin\$(Configuration)\</AutoVersionTaskFolder>
        <AutoVersionTaskFolder Condition=" '$(AutoVersionTaskDebug)' != 'True' ">$(MSBuildThisFileDirectory)..\tasks\netstandard2.0\</AutoVersionTaskFolder>
    </PropertyGroup>

    <UsingTask TaskName="MainTask" AssemblyFile="$(AutoVersionTaskFolder)AutoVersionTask.dll" />

    <Target Name="MainTaskTarget" BeforeTargets="CoreCompile;GetAssemblyVersion;GenerateNuspec" Condition=" '$(Version)' == '1.0.0' ">
        <MainTask TaskDir="$(AutoVersionTaskFolder)" ProjectDir="$(MSBuildProjectDirectory)">
            <Output TaskParameter="AutoVersion" PropertyName="AutoVersion" />
            <Output TaskParameter="AutoVersionPrefix" PropertyName="AutoVersionPrefix" />
            <Output TaskParameter="AutoVersionSuffix" PropertyName="AutoVersionSuffix" />
        </MainTask>
        <PropertyGroup>
            <Version>$(AutoVersion)</Version>
            <VersionPrefix>$(AutoVersionPrefix)</VersionPrefix>
            <VersionSuffix>$(AutoVersionSuffix)</VersionSuffix>
            <PackageVersion>$(AutoVersion)</PackageVersion>
        </PropertyGroup>
    </Target>
</Project>
